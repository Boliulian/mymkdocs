
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="make time seen">
      
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>开发记录 - 榴莲的笔记本</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="." title="榴莲的笔记本" class="md-header__button md-logo" aria-label="榴莲的笔记本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            榴莲的笔记本
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              开发记录
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  
    
  
  首页

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="%E8%87%AA%E6%88%91%E8%A7%89%E5%AF%9F.html" class="md-tabs__link">
          
  
  
    
  
  归一

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="%E5%90%8D%E6%9F%AF%E8%AE%B0%E5%BD%95.html" class="md-tabs__link">
          
  
  
    
  
  兴趣

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="%E6%97%A5%E5%B8%B8%E7%AE%A1%E7%90%86.html" class="md-tabs__link">
          
  
  
    
  
  生活

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="%E5%B7%A5%E5%85%B7%E7%AE%B1.html" class="md-tabs__link">
          
  
  
    
  
  工具箱

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="榴莲的笔记本" class="md-nav__button md-logo" aria-label="榴莲的笔记本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    榴莲的笔记本
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            首页
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    归一
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            归一
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E8%87%AA%E6%88%91%E8%A7%89%E5%AF%9F.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    自我觉察
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%AE%87%E5%AE%99%E4%BB%B0%E8%A7%82.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    宇宙仰观
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    兴趣
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            兴趣
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%90%8D%E6%9F%AF%E8%AE%B0%E5%BD%95.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    名柯记录
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%96%9C%E6%AC%A2%E7%9A%84%E7%94%BB.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    喜欢的画
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%B7%A7%E6%98%9F%E8%AE%B0%E5%BD%95.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    巧星记录
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    生活
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            生活
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E6%97%A5%E5%B8%B8%E7%AE%A1%E7%90%86.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    日常管理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%A5%BD%E7%89%A9%E8%AE%B0%E5%BD%95.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    好物记录
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%B7%AE%E7%89%A9%E8%AE%B0%E5%BD%95.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    差物记录
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%8C%BB%E8%8D%AF%E7%AE%B1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    医药箱
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    工具箱
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            工具箱
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="%E5%B7%A5%E5%85%B7%E7%AE%B1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    工具箱
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plot" class="md-nav__link">
    <span class="md-ellipsis">
      Plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#torch" class="md-nav__link">
    <span class="md-ellipsis">
      Torch
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Torch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tips" class="md-nav__link">
    <span class="md-ellipsis">
      TIPS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cuda" class="md-nav__link">
    <span class="md-ellipsis">
      CUDA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      LINUX
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LINUX">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      系统
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      脚本
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vim" class="md-nav__link">
    <span class="md-ellipsis">
      vim
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      安装docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      编写Dockerfile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      使用容器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      服务器使用镜像
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ide" class="md-nav__link">
    <span class="md-ellipsis">
      IDE
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IDE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wsl" class="md-nav__link">
    <span class="md-ellipsis">
      WSL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vs-code" class="md-nav__link">
    <span class="md-ellipsis">
      VS code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anaconda" class="md-nav__link">
    <span class="md-ellipsis">
      Anaconda
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#github" class="md-nav__link">
    <span class="md-ellipsis">
      Github
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Github">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssh" class="md-nav__link">
    <span class="md-ellipsis">
      SSH
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hpc" class="md-nav__link">
    <span class="md-ellipsis">
      HPC
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>开发记录</h1>

<h2 id="python">Python</h2>
<h3 id="plot">Plot</h3>
<p>时间序列</p>
<p>函数定义时指定数据类型 <code>-&gt;</code></p>
<pre><code class="language-python">def validate_data(data: xr.Dataset) -&gt; Tuple[xr.Dataset]:
</code></pre>
<h3 id="torch">Torch</h3>
<p>cuda信息</p>
<pre><code class="language-python">torch.version.cuda
torch.__version__
torch.cuda.is_available()
torch.cuda.device_count()
torch.cuda.get_device_name()
torch.cuda.get_device_capability()
</code></pre>
<h4 id="tips">TIPS</h4>
<p>pip安装的包conda remove删不掉</p>
<p>用全大写字母表示常量定义，小写字母表示变量，是一种约定俗成，来表示某些值应该被视为常量</p>
<p>fstring动态字符串，f"mask_{lev}"的结果是"mask_0"，在动态输出的时候经常用到</p>
<h2 id="cuda">CUDA</h2>
<p>torch和cuda的匹配规则</p>
<ul>
<li>python和pytorch匹配矩阵：<a href="https://lightning.ai/docs/pytorch/latest/versioning.html#compatibility-matrix">Versioning Policy — PyTorch Lightning 2.5.1rc2 documentation</a></li>
<li>
<p>pytorch和cuda匹配安装列表：<a href="https://link.zhihu.com/?target=https%3A//pytorch.org/get-started/previous-versions/">PyTorch</a></p>
</li>
<li>
<p>pytorch自动生成匹配安装命令：<a href="https://pytorch.org/get-started/locally/">Get Started</a></p>
</li>
</ul>
<p>安装cuda和cudnn</p>
<p><a href="https://zhuanlan.zhihu.com/p/198161777">非root用户安装cuda与cudnn - 知乎</a></p>
<p><a href="https://developer.nvidia.com/cuda-toolkit-archive">CUDA Toolkit Archive | NVIDIA Developer</a></p>
<p><a href="https://developer.nvidia.com/rdp/cudnn-archive">cuDNN Archive | NVIDIA Developer</a></p>
<pre><code class="language-bash">export CUDA_HOME=$CUDA_HOME:/home/qd_zlliu/cuda-12.1
export PATH=&quot;/public/home/jd_lulin/cuda-10.1/bin:$PATH&quot;
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/qd_zlliu/cuda-12.1/lib64
</code></pre>
<pre><code class="language-bash">cp cudnn-linux-x86_64-8.9.7.29_cuda12-archive/include/cudnn*.h cuda-12.1/include/
cp cudnn-linux-x86_64-8.9.7.29_cuda12-archive/lib/libcudnn* cuda-12.1/lib64/
chmod a+r cuda-12.1/include/cudnn*.h cuda-12.1/lib64//libcudnn*
</code></pre>
<p>各服务器nvidia驱动和cuda版本</p>
<pre><code class="language-bash">国实gpu1：550.54.15 12.4

gpu12：550.90.07 12.4

gpu15：515.105.01 11.7

gpu16：460.73.01 11.2

gpu17：535.104.12 12.2

gpu18：535.104.12 12.2
</code></pre>
<h2 id="linux">LINUX</h2>
<h3 id="_1">系统</h3>
<p>连接GPU资源（需要用私钥</p>
<pre><code class="language-bash">ssh -i ~/.ssh/id_rsa qd_zlliu@10.16.202.17 -p 22
ssh -i ~/.ssh/id_rsa qd_zlliu@10.16.202.18 -p 22
</code></pre>
<p>查看gpu</p>
<pre><code class="language-bash">nvidia-smi
nvidia-smi -q | grep &quot;Product Name&quot;
</code></pre>
<p>实时监测gpu</p>
<pre><code class="language-bash">watch -n 1 nvidia-smi 
</code></pre>
<p>查看硬件拓扑</p>
<pre><code class="language-bash">nvidia-smi topo -m
</code></pre>
<p>查看cpu信息</p>
<pre><code class="language-bash">lscpu
</code></pre>
<p>查看cpu内存</p>
<pre><code class="language-bash">free -h
</code></pre>
<p>查看硬盘空间</p>
<pre><code class="language-bash">df -h
</code></pre>
<p>查看当前磁盘使用情况</p>
<pre><code class="language-bash">lfs quota h/home
</code></pre>
<p>查看目录大小</p>
<pre><code class="language-bash">du -sh
</code></pre>
<p>终止进程</p>
<pre><code class="language-bash">kill -15 &lt;PID&gt;  #优雅
kill -9 &lt;PID&gt; #强制
</code></pre>
<p>查看时区</p>
<pre><code class="language-bash">cat /etc/timezone
</code></pre>
<p>Module</p>
<p>查看可用module</p>
<pre><code class="language-bash">module avail
</code></pre>
<p>加载module</p>
<pre><code class="language-bash">module load [name]
</code></pre>
<p>卸载module</p>
<p>集群上已安装docker</p>
<h3 id="_2">文件</h3>
<p>新建目录</p>
<pre><code class="language-bash">mkdir
</code></pre>
<p>转到目录</p>
<pre><code class="language-bash">cd
</code></pre>
<p>删除目录</p>
<pre><code class="language-bash">rmdir
</code></pre>
<p>复制文件</p>
<pre><code class="language-bash">cp [source] [to]
</code></pre>
<p>同步文件</p>
<pre><code class="language-bash">rsync -a [source] [to]
</code></pre>
<p>移动文件</p>
<pre><code class="language-bash">mv [source] [to]
</code></pre>
<p>压缩目录</p>
<pre><code class="language-bash">tar -czvf 输出文件名.tar.gz 要压缩的文件或目录
</code></pre>
<p>解压tar文件</p>
<pre><code class="language-bash">tar -xzvf archive.tar.gz
tar -xJvf cudnn-linux-x86_64-8.9.7.29_cuda12-archive.tar.xz
</code></pre>
<p>显示所有文件和目录，包括隐藏</p>
<pre><code class="language-bash">ls -a   
</code></pre>
<p>删除文件或目录，-r表示递归，-f表示强制删除</p>
<pre><code class="language-bash">rm -r [file/dir]
</code></pre>
<p>修改用户配置文件</p>
<pre><code class="language-bash">sudo gedit ~/.bashrc    # 修改用户配置文件:/home/duriannut
source ~/.bashrc        # 修改完以后激活
</code></pre>
<p>显示环境变量</p>
<pre><code class="language-bash">printenv
</code></pre>
<p>修改文件权限</p>
<pre><code class="language-bash">chmod 777 file
chmod 644 file
</code></pre>
<p>解压文件</p>
<pre><code class="language-bash">tar -C [dir] *.tar.gz
</code></pre>
<p>everything从本机传文件到虚拟机</p>
<pre><code class="language-bash">wget [link] --user root --password 123123
</code></pre>
<p>setup.py安装</p>
<pre><code class="language-bash">sudo python setup.py install
</code></pre>
<p>创建符号链接</p>
<pre><code class="language-bash">ln -sf ~/datasets .datasets
</code></pre>
<p>查看符号链接路径</p>
<pre><code class="language-bash">ls -l INPUT/ocean_hgrid.nc
</code></pre>
<h3 id="_3">脚本</h3>
<p>bash循环语句使用方法：https://www.yiibai.com/bash/bash-for-loop.html</p>
<pre><code class="language-bash">arr=&quot;100 200 300&quot;
for i in $arr;do
echo $i
done
</code></pre>
<h3 id="vim">vim</h3>
<p>进入插入模式</p>
<pre><code class="language-bash">i
</code></pre>
<p>退出插入模式</p>
<pre><code class="language-bash">esc
</code></pre>
<p>保存并退出</p>
<pre><code class="language-bash">:wq
</code></pre>
<h2 id="docker">Docker</h2>
<h3 id="docker_1">安装docker</h3>
<p>课件地址：https://docker.easydoc.net
官方安装文档：https://docs.docker.com/engine/install/ubuntu/</p>
<p>卸载旧版本</p>
<pre><code class="language-bash">for pkg in docker.io docker-doc docker-compose docker-compose-v2 podman-docker containerd runc; do sudo apt-get remove $pkg; done
</code></pre>
<p>更新apt库</p>
<pre><code class="language-bash"># Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release &amp;&amp; echo &quot;${UBUNTU_CODENAME:-$VERSION_CODENAME}&quot;) stable&quot; | \
  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
sudo apt-get update
</code></pre>
<p>安装docker包</p>
<pre><code class="language-bash">sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo systemctl start docker
</code></pre>
<p>运行测试镜像hello-world，失败</p>
<pre><code class="language-bash">sudo docker run hello-world
</code></pre>
<p>是因为网太差，需要更换镜像源，参考docker运行hello-world镜像失败：<a href="https://blog.csdn.net/oyjl__/article/details/143522664">Docker运行hello-world镜像失败或超时：Unable to find image ‘hello-world:latest‘ locally Trying to pull reposi_unable to find image 'hello-world:latest' locally-CSDN博客</a></p>
<pre><code class="language-bash">sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'
{
    &quot;registry-mirrors&quot;: [
        &quot;https://do.nark.eu.org&quot;,
        &quot;https://dc.j8.work&quot;,
        &quot;https://docker.m.daocloud.io&quot;,
        &quot;https://dockerproxy.com&quot;,
        &quot;https://docker.mirrors.ustc.edu.cn&quot;,
        &quot;https://docker.nju.edu.cn&quot;,
        &quot;https://docker.1ms.run&quot;,
        &quot;https://docker.xuanyuan.me&quot;

    ]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
systemctl status docker
</code></pre>
<p>再次运行sudo docker run hello-world，成功</p>
<h3 id="dockerfile">编写Dockerfile</h3>
<p>镜像源，可用[<a href="https://blog.csdn.net/FL1623863129/article/details/132275060">docker]nvidia的cuda镜像列表-CSDN博客</a></p>
<pre><code class="language-bash">sudo docker pull nvcr.io/nvidia/cuda:12.1.0-cudnn8-runtime-ubuntu22.04
</code></pre>
<p>参考<a href="https://www.cnblogs.com/jinyuanbao/p/18451810">Ubuntu24.02使用Docker搭建CUDA12.2环境过程 - 金元宝骑骑 - 博客园</a></p>
<p>Dockerfile：</p>
<pre><code class="language-dockerfile">FROM nvcr.io/nvidia/cuda:12.1.0-cudnn8-runtime-ubuntu22.04

RUN apt-get update &amp;&amp; apt-get install -y curl wget vim python3-pip

# 安装anaconda
RUN wget -P /tmp https://repo.anaconda.com/archive/Anaconda3-2024.10-1-Linux-x86_64.sh \
    &amp;&amp; chmod +x /tmp/Anaconda3-2024.10-1-Linux-x86_64.sh \
    &amp;&amp; sh /tmp/Anaconda3-2024.10-1-Linux-x86_64.sh -b -p /opt/anaconda3 \
    &amp;&amp; rm /tmp/Anaconda3-2024.10-1-Linux-x86_64.sh

# conda设置
RUN conda config --set show_channel_urls yes \
 &amp;&amp; conda config --set auto_activate_base no \
 &amp;&amp; conda update conda -y &amp;&amp; conda update --all \
 &amp;&amp; conda init bash

WORKDIR /samudra
COPY ./environment.yml /samudra

 # 创建samudra环境
RUN conda env create -f environment.yml \
 &amp;&amp; conda activate samudra \
 &amp;&amp; cd /samudra

ENV TZ=Asia/Shanghai \
PATH=/opt/anaconda3/bin:$PATH

 #清楚临时文件和缓存
RUN apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*


EXPOSE 22
EXPOSE 6006
EXPOSE 8888

CMD [&quot;bash&quot;]
</code></pre>
<p>cd到Dockerfile（D大写）目录</p>
<p>创建镜像</p>
<pre><code class="language-bash">sudo docker build -t samudra:latest .
</code></pre>
<p>这段时间根据报错不断调整Dockerfile，然后重来</p>
<p>*不要更换清华源，conda update反而变慢</p>
<p>查看所有镜像</p>
<pre><code class="language-bash">sudo docker images
</code></pre>
<p>删除镜像</p>
<pre><code class="language-bash">docker rmi &lt;image&gt;
</code></pre>
<h3 id="_4">使用容器</h3>
<p>进入容器（未运行）</p>
<pre><code class="language-bash">sudo docker run -it --name my-test-container my-image /bin/bash
</code></pre>
<p>进入容器（已运行）</p>
<pre><code class="language-bash">sudo docker exec -it my-python-container /bin/bash
</code></pre>
<p>进入容器并添加挂载目录</p>
<pre><code class="language-bash">sudo docker run -it --gpus all --name mycontainer -v /home/lzl/samudra/code:/workspace/code -v /home/lzl/samudra/data:/workspace/data samudra /bin/bash
</code></pre>
<p>查看所有容器</p>
<pre><code class="language-bash">sudo docker ps -a
</code></pre>
<p>退出容器</p>
<pre><code class="language-bash">sudo docker stop mycontainer
</code></pre>
<p>删除容器</p>
<pre><code class="language-bash">sudo docker rm mycontainer
</code></pre>
<p><strong>[已解决] 容器无法识别gpu资源</strong></p>
<p>更新docker版本</p>
<pre><code class="language-bash">sudo apt update
sudo apt upgrade docker-ce
sudo systemctl restart docker
</code></pre>
<p>安装nvidia容器工具</p>
<p><a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html">Installing the NVIDIA Container Toolkit — NVIDIA Container Toolkit</a></p>
<p>修改docker配置文件</p>
<pre><code class="language-bash">sudo nvidia-ctk runtime configure --runtime=docker
</code></pre>
<p>重新启动</p>
<pre><code class="language-bash">sudo systemctl restart docker
</code></pre>
<h3 id="_5">服务器使用镜像</h3>
<p>导出镜像</p>
<pre><code class="language-bash">sudo docker save -o samudra_image.tar samudra
</code></pre>
<p>载入镜像</p>
<pre><code class="language-bash">docker load &lt; samudra_img.tar
</code></pre>
<p><strong>[已解决]问题：服务器docker需要root权限</strong></p>
<p>尝试Udocker替代，功能不全，失败</p>
<p>联系管理员添加权限</p>
<p>查看用户组</p>
<pre><code class="language-bash">grep docker /etc/group
</code></pre>
<p>问题：载入镜像报错</p>
<pre><code class="language-bash">docker load &lt; samudra_img.tar
open /var/lib/docker/tmp/docker-import-885058880/blobs/json: no such file or directory
</code></pre>
<p>换另一种方式仍然报错</p>
<pre><code class="language-bash">cat samudra_img.tar | docker import - samudra_img
Error response from daemon: ApplyLayer exit status 1 stdout:  stderr: write /opt/anaconda3/envs/samudra/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so: no space left on device
</code></pre>
<p>尝试减小镜像体积，只保留ubuntu环境</p>
<pre><code class="language-bash">sudo docker build -t ubuntu_docker:latest .
</code></pre>
<p>导出镜像</p>
<pre><code class="language-bash">sudo docker save -o ubuntu_docker.tar ubuntu_docker
</code></pre>
<p><strong>[已解决]问题：镜像文件无法通过xftp传输</strong></p>
<p>经检查为权限问题</p>
<pre><code class="language-bash">ls -la
-rw------- 1 root root 3839890432 May 14 12:17 ubuntu_docker.tar
</code></pre>
<p>更改用户名和权限</p>
<pre><code class="language-bash">sudo chown lzl:lzl ubuntu_docker.tar
chmod 644 ubuntu_docker.tar
</code></pre>
<p>载入镜像</p>
<pre><code class="language-bash">docker load &lt; ubuntu_docker.tar
</code></pre>
<p>运行容器，挂载anaconda，code，data，启动gpu</p>
<pre><code class="language-bash">docker run -it --gpus all --name samudra -v /home/qd_zlliu/samudra/code:/samudra/code -v /home/qd_zlliu/samudra/data:/samudra/data -v /home/qd_zlliu/anaconda3:/samudra/anaconda3 ubuntu_docker /bin/bash
</code></pre>
<p><strong>[未解决]问题：docker run无gpu参数，nvidia-smi无法识别</strong></p>
<p>docker18以下无--gpu命令</p>
<p>参考：<a href="https://www.cnblogs.com/chester-cs/p/17857447.html">如何在较旧版本的docker中使用gpu - 思念殇千寻 - 博客园</a></p>
<pre><code class="language-bash">nvidia-docker run -it --name samudra -v /home/qd_zlliu/samudra/code:/samudra/code -v /home/qd_zlliu/samudra/data:/samudra/data -v /home/qd_zlliu/anaconda3:/samudra/anaconda3 --device /dev/nvidia0:/dev/nvidia0 --device /dev/nvidia1:/dev/nvidia1 --device /dev/nvidia2:/dev/nvidia2 --device /dev/nvidia3:/dev/nvidia3 --device /dev/nvidia4:/dev/nvidia4 --device /dev/nvidia5:/dev/nvidia5 --device /dev/nvidia6:/dev/nvidia6 --device /dev/nvidia7:/dev/nvidia7 --device /dev/nvidiactl:/dev/nvidiactl --device /dev/nvidia-uvm:/dev/nvidia-uvm --device /dev/nvidia-uvm-tools:/dev/nvidia-uvm-tools -v nvidia_driver_535.104.12:/usr/local/nvidia:ro ubuntu_docker /bin/bash
</code></pre>
<p>找不到nvidia文件夹，作罢</p>
<h2 id="ide">IDE</h2>
<h3 id="wsl">WSL</h3>
<p><strong>安装wsl</strong></p>
<p>wsl是windows subsystem for linux，win10以上自带内置虚拟机</p>
<pre><code class="language-bash">wsl --install
</code></pre>
<p>注意需要连接vpn，否则极慢！</p>
<p><strong>联动vs code和wsl</strong></p>
<p>code内安装wsl插件</p>
<p>终端内<code>code .</code> 可直接打开界面</p>
<p><strong>配置anaconda</strong></p>
<pre><code class="language-bash">wget -P ~ https://repo.anaconda.com/archive/Anaconda3-2024.10-1-Linux-x86_64.sh #获取最新版anaconda
bash ~/Anaconda3-2024.10-1-Linux-x86_64.sh #安装 一路选yes
conda create -n mypy python=3.11 anaconda #配置环境
conda activate mypy
</code></pre>
<p>给自己的环境命名为了<strong>mypy</strong></p>
<p><strong>安装cursor</strong></p>
<p><a href="https://www.cursor.com/cn">Cursor - The AI Code Editor</a>
使用github账号登录</p>
<p>完全继承vs code所有插件和界面功能，可从vs code一键导入所有配置，<strong>ide可直接用cursor</strong> </p>
<p><strong>vscode + copilot</strong></p>
<p>cursor存在访问隐患。有网络限制的情况下用vscode + copilot配合deepseek作为替代方案</p>
<p><strong>将wsl迁移出C盘</strong></p>
<p>wsl默认安装在C盘，持续使用终有一天会不幸</p>
<p>参考以下帖子和ds回答</p>
<p><a href="https://www.cnblogs.com/yjmyzz/p/wsl2-tutorial-1.html#:~:text=默认是安装在C盘的，随着虚拟机里软件越装越多，很快C盘的空间就吃紧了，而且比较坑的是，就算在虚拟机里把文件给删除了，空间也不会被释放。,解决方案： 默认位置类似：C%3AUsersAdministratorAppDataLocalPackagesCanonicalGroupLimited.Ubuntu22.04LTS_79rhkp1fndgscLocalStateext4.vhdx">windows WSL2避坑指南 - 菩提树下的杨过 - 博客园</a></p>
<p><a href="https://blog.csdn.net/whitepu/article/details/136177105">windows wsl下使用Ubuntu，保存在其他盘中_wsl安装的ubuntu在哪里-CSDN博客</a></p>
<pre><code class="language-bash"># 查看发行版名称
wsl -l -v
# 关闭 WSL
wsl --shutdown
# 导出发行版
wsl --export Ubuntu D:\wsl_backup.tar
# 注销原发行版
wsl --unregister Ubuntu
# 导入到新位置
wsl --import Ubuntu D:\WSL\ D:\wsl_backup.tar --version 2
</code></pre>
<p><strong>remote-ssh</strong>失败</p>
<p>vscode版本太新，远程服务器glib版本不够</p>
<p>需要vscode降级</p>
<h3 id="vs-code">VS code</h3>
<p>快捷键cmd+shift+P</p>
<p>全局搜索cmd+shift+F</p>
<p>launch.json文件必须放在.vscode下面</p>
<h3 id="anaconda">Anaconda</h3>
<p>安装Anaconda</p>
<pre><code class="language-bash">wget -P ~ https://repo.anaconda.com/archive/Anaconda3-2024.10-1-Linux-x86_64.sh #获取最新版anaconda
bash ~/Anaconda3-2024.10-1-Linux-x86_64.sh #安装 一路选yes
</code></pre>
<p>更新conda包</p>
<pre><code class="language-bash">conda update conda
conda update --all
</code></pre>
<p>查看环境列表</p>
<pre><code class="language-bash">conda env list
</code></pre>
<p>创建环境</p>
<pre><code class="language-bash">conda create -n mom6py jupyter xarray matplotlib numpy netcdf4

conda env create -f environment.yml
</code></pre>
<p>激活环境</p>
<pre><code class="language-bash">conda activate mom6py
</code></pre>
<p>反激活环境</p>
<pre><code class="language-bash">conda deactivate
</code></pre>
<p>移除环境</p>
<pre><code class="language-bash">conda env remove --name samudra
</code></pre>
<p>克隆环境</p>
<pre><code class="language-bash">conda create --name samudra_cu121 --clone samudra
</code></pre>
<h2 id="github">Github</h2>
<p><strong>GitDiagram</strong></p>
<p>自动绘制项目框架图，将github换成gitdiagram</p>
<pre><code class="language-bash">https://github.com/m2lines/samudra
https://gitdiagram.com/m2lines/samudra
</code></pre>
<h3 id="ssh">SSH</h3>
<p>配置github SSH</p>
<p>新电脑第一次git clone前需要做的事情</p>
<pre><code class="language-bash">ls ~/.ssh
</code></pre>
<p>如果没有id_rsa和id_rsa.pub文件</p>
<pre><code class="language-bash">ssh-keygen -t rsa
cat ~/.ssh/id_rsa.pub
</code></pre>
<p>将内容复制到github新key中
检查是否连接成功</p>
<pre><code class="language-bash">ssh -T git@github.com
</code></pre>
<p>设置全局身份</p>
<pre><code class="language-bash">git config --global user.email &quot;你的邮箱（如 GitHub 注册邮箱）&quot;
git config --global user.name &quot;name&quot;
</code></pre>
<p>首次绑定？</p>
<pre><code class="language-bash">git init
git remote add origin https://github.com/your-username/my-project.git
git add .
git commit -m &quot;第一次提交&quot;  # 创建初始提交
git push -u origin master
</code></pre>
<p>后续更新</p>
<pre><code>git add .
git commit -m &quot;更新内容&quot;
git push
</code></pre>
<p>查看远程仓库</p>
<pre><code class="language-bash">git remote -v
</code></pre>
<p>删除远程仓库</p>
<pre><code class="language-bash">git remote remove origin
</code></pre>
<h2 id="hpc">HPC</h2>
<p>超算 节点数 核数</p>
<p>https://top500.org/</p>
<p>美国 El Capitan 1.1万 1.1千万
https://www.llnl.gov/article/52061/lawrence-livermore-national-laboratorys-el-capitan-verified-worlds-fastest-supercomputer</p>
<p>美国 Frontier 9千 8百万
https://docs.olcf.ornl.gov/systems/frontier_user_guide.html</p>
<p>日本 Fugaku 15万 7百万
https://www.r-ccs.riken.jp/en/fugaku/about/</p>
<p>美国 Aurora 1万 1.1百万
https://www.tomshardware.com/tech-industry/supercomputers/aurora-supercomputer-is-now-fully-operational-available-to-researchers</p>
<p>微软Eagle 2百万</p>
<p>samudra结构图</p>
<pre><code class="language-mermaid">flowchart TB
    %% External Data Sources
    subgraph &quot;External Data Sources&quot;
        OM4_Zarr[&quot;OM4 Zarr Datasets&quot;]:::external
        OM4_Stats[&quot;OM4 Statistics&quot;]:::external
    end
%% Configuration Management
subgraph &quot;Configuration Management&quot;
    ConfigTrain[&quot;train_samudra_om4.yaml&quot;]:::config
    ConfigRollout[&quot;rollout_samudra_om4.yaml&quot;]:::config
    ConfigParser[&quot;config.py&quot;]:::config
end

%% Data Ingestion &amp; Preprocessing
subgraph &quot;Data Ingestion &amp; Preprocessing&quot;
    Datasets[&quot;datasets.py&quot;]:::data
    DataUtils[&quot;utils/data.py&quot;]:::data
    Normalization[&quot;Normalization\n(means/stds)&quot;]:::data
end

%% Model Definition
subgraph &quot;Model Definition&quot;
    Activations[&quot;activations.py&quot;]:::model
    Blocks[&quot;blocks.py&quot;]:::model
    Factory[&quot;factory.py&quot;]:::model
    SamudraCore[&quot;samudra.py&quot;]:::model
end

%% Training Orchestration
subgraph &quot;Training Orchestration&quot;
    TrainScript[&quot;train.py&quot;]:::compute
    StepperTrain[&quot;stepper.py&quot;]:::compute
    TrainUtils[&quot;utils/train.py&quot;]:::compute
    Dist[&quot;utils/distributed.py&quot;]:::compute
    Writer[&quot;utils/writer.py&quot;]:::compute
end

%% Rollout / Inference
subgraph &quot;Rollout / Inference&quot;
    RolloutScript[&quot;rollout.py&quot;]:::compute
    StepperRollout[&quot;stepper.py&quot;]:::compute
end

%% Utilities
subgraph &quot;Utilities&quot;
    Logging[&quot;logging.py&quot;]:::utils
    Device[&quot;device.py&quot;]:::utils
    NotebookUtil[&quot;notebook.py&quot;]:::utils
end

%% Visualization &amp; Analysis
subgraph &quot;Visualization &amp; Analysis&quot;
    Notebook[&quot;samudra_plotting.ipynb&quot;]:::viz
    Assets[&quot;assets&quot;]:::viz
end

%% Connections
ConfigTrain --&gt; ConfigParser
ConfigRollout --&gt; ConfigParser
ConfigParser --&gt; TrainScript
ConfigParser --&gt; RolloutScript

OM4_Zarr --&gt; Datasets
OM4_Stats --&gt; Normalization
Datasets --&gt; Normalization
Normalization --&gt;|&quot;PyTorch Tensor&quot;| TrainScript
Normalization --&gt;|&quot;PyTorch Tensor&quot;| RolloutScript

TrainScript --&gt; StepperTrain
RolloutScript --&gt; StepperRollout

StepperTrain --&gt; SamudraCore
StepperRollout --&gt; SamudraCore

Activations --&gt; Factory
Blocks --&gt; Factory
Factory --&gt; SamudraCore

TrainScript --&gt; TrainUtils
TrainScript --&gt; Dist
TrainScript --&gt; Writer
TrainScript --&gt; Logging
TrainScript --&gt; Device

RolloutScript --&gt; Logging
RolloutScript --&gt; Device

Writer --&gt; Assets
Notebook --&gt; Assets
Notebook --&gt; NotebookUtil

%% Click Events
click ConfigTrain &quot;https://github.com/m2lines/samudra/blob/main/configs/train_samudra_om4.yaml&quot;
click ConfigRollout &quot;https://github.com/m2lines/samudra/blob/main/configs/rollout_samudra_om4.yaml&quot;
click ConfigParser &quot;https://github.com/m2lines/samudra/blob/main/src/config.py&quot;
click Datasets &quot;https://github.com/m2lines/samudra/blob/main/src/datasets.py&quot;
click DataUtils &quot;https://github.com/m2lines/samudra/blob/main/src/utils/data.py&quot;
click Activations &quot;https://github.com/m2lines/samudra/blob/main/src/models/activations.py&quot;
click Blocks &quot;https://github.com/m2lines/samudra/blob/main/src/models/blocks.py&quot;
click Factory &quot;https://github.com/m2lines/samudra/blob/main/src/models/factory.py&quot;
click SamudraCore &quot;https://github.com/m2lines/samudra/blob/main/src/models/samudra.py&quot;
click TrainScript &quot;https://github.com/m2lines/samudra/blob/main/src/train.py&quot;
click StepperTrain &quot;https://github.com/m2lines/samudra/blob/main/src/stepper.py&quot;
click TrainUtils &quot;https://github.com/m2lines/samudra/blob/main/src/utils/train.py&quot;
click Dist &quot;https://github.com/m2lines/samudra/blob/main/src/utils/distributed.py&quot;
click Writer &quot;https://github.com/m2lines/samudra/blob/main/src/utils/writer.py&quot;
click RolloutScript &quot;https://github.com/m2lines/samudra/blob/main/src/rollout.py&quot;
click Logging &quot;https://github.com/m2lines/samudra/blob/main/src/utils/logging.py&quot;
click Device &quot;https://github.com/m2lines/samudra/blob/main/src/utils/device.py&quot;
click NotebookUtil &quot;https://github.com/m2lines/samudra/blob/main/src/utils/notebook.py&quot;
click Notebook &quot;https://github.com/m2lines/samudra/blob/main/notebooks/samudra_plotting.ipynb&quot;
click Assets &quot;https://github.com/m2lines/samudra/tree/main/assets/&quot;

%% Styles
classDef external fill:#bbdefb,stroke:#333,stroke-width:1px
classDef config fill:#fff59d,stroke:#333,stroke-width:1px
classDef data fill:#b3e5fc,stroke:#333,stroke-width:1px
classDef model fill:#c8e6c9,stroke:#333,stroke-width:1px
classDef compute fill:#a5d6a7,stroke:#333,stroke-width:1px
classDef utils fill:#eeeeee,stroke:#333,stroke-width:1px
classDef viz fill:#ffe0b2,stroke:#333,stroke-width:1px
</code></pre>
<p>aurora结构图</p>
<pre><code class="language-mermaid">flowchart TD
    %% External Dependencies
    subgraph &quot;External Services&quot; 
        direction TB
        PyTorch[&quot;PyTorch&quot;]:::external
        MLflowServer[&quot;MLflow Server&quot;]:::external
        FoundryCloud[&quot;Palantir Foundry&quot;]:::external
    end

    %% Data Layer
    subgraph &quot;Data Preprocessor&quot; 
        direction TB
        Batch[&quot;Batch&quot;]:::core
        Area[&quot;area.py&quot;]:::core
        Normalisation[&quot;normalisation.py&quot;]:::core
    end

    %% Model Layer
    subgraph &quot;Aurora Model&quot; 
        direction TB
        Encoder[&quot;encoder.py&quot;]:::core
        Decoder[&quot;decoder.py&quot;]:::core
        Fourier[&quot;fourier.py&quot;]:::core
        LoRA[&quot;lora.py&quot;]:::core
        CoreModel[&quot;aurora.py&quot;]:::core
        Utils[&quot;Other Layers &amp; Utils&quot;]:::core
    end

    %% Inference Layer
    subgraph &quot;Inference &amp; Rollout&quot;
        direction TB
        Rollout[&quot;rollout.py&quot;]:::core
        Tracker[&quot;tracker.py&quot;]:::core
    end

    %% Integration Layer
    subgraph &quot;Foundry Integration&quot;
        direction TB
        subgraph &quot;Client&quot; 
            direction TB
            FAPI[&quot;api.py&quot;]:::integration
            FClient[&quot;foundry.py&quot;]:::integration
            Channel[&quot;common/channel.py&quot;]:::integration
            FModel[&quot;common/model.py&quot;]:::integration
            Demo[&quot;demo/&quot;]:::integration
        end
        subgraph &quot;Server &amp; MLflow Plugin&quot;
            direction TB
            MLWrapper[&quot;mlflow_wrapper.py&quot;]:::integration
            MLPlugin[&quot;package_mlflow.py&quot;]:::integration
        end
    end

    %% Documentation &amp; Examples
    Docs[&quot;docs/&quot;]:::docs

    %% CI/CD &amp; Publishing
    subgraph &quot;CI/CD &amp; Publishing&quot;
        direction TB
        CI[&quot;.github/workflows/ci.yaml&quot;]:::ci
        DocsBuild[&quot;.github/workflows/build_docs.yaml&quot;]:::ci
        Format[&quot;.github/workflows/formatting.yaml&quot;]:::ci
        Publish[&quot;.github/workflows/publish.yaml&quot;]:::ci
        Makefile[&quot;Makefile&quot;]:::ci
    end

    %% Testing
    Tests[&quot;tests/&quot;]:::tests

    %% Data Flow &amp; Control Flow
    User[&quot;User Script&quot;]:::actor
    User --&gt;|&quot;instantiate Batch/Metadata&quot;| Batch
    User --&gt;|&quot;instantiate Batch/Metadata&quot;| Area
    User --&gt;|&quot;instantiate Batch/Metadata&quot;| Normalisation
    Batch --&gt;|&quot;processed data&quot;| CoreModel
    Area --&gt;|&quot;area data&quot;| CoreModel
    Normalisation --&gt;|&quot;normalized data&quot;| CoreModel
    CoreModel --&gt;|&quot;Prediction&quot;| Rollout
    Rollout --&gt;|&quot;time-series steps&quot;| Tracker
    Tracker --&gt;|&quot;MLflow log&quot;| MLflowServer
    MLPlugin --&gt;|&quot;wraps model&quot;| CoreModel
    MLWrapper --&gt;|&quot;logs via MLflow&quot;| MLflowServer

    %% Integration Flows
    FAPI --&gt;|&quot;calls&quot;| MLWrapper
    FClient --&gt;|&quot;submits job&quot;| FoundryCloud
    FoundryCloud --&gt;|&quot;invokes&quot;| MLWrapper
    MLWrapper --&gt;|&quot;executes model&quot;| CoreModel

    %% CI/CD &amp; Docs &amp; Tests
    CI --&gt;|runs| Tests
    CI --&gt;|builds| Docs
    CI --&gt;|formats| CoreModel
    CI --&gt;|publishes| MLPlugin

    %% Dependencies
    CoreModel --&gt; PyTorch
    MLWrapper --&gt; MLflowServer
    FClient --&gt; FoundryCloud

    %% Click Events
    click Batch &quot;https://github.com/microsoft/aurora/blob/main/aurora/batch.py&quot;
    click Area &quot;https://github.com/microsoft/aurora/blob/main/aurora/area.py&quot;
    click Normalisation &quot;https://github.com/microsoft/aurora/blob/main/aurora/normalisation.py&quot;
    click Encoder &quot;https://github.com/microsoft/aurora/blob/main/aurora/model/encoder.py&quot;
    click Decoder &quot;https://github.com/microsoft/aurora/blob/main/aurora/model/decoder.py&quot;
    click Fourier &quot;https://github.com/microsoft/aurora/blob/main/aurora/model/fourier.py&quot;
    click LoRA &quot;https://github.com/microsoft/aurora/blob/main/aurora/model/lora.py&quot;
    click CoreModel &quot;https://github.com/microsoft/aurora/blob/main/aurora/model/aurora.py&quot;
    click Rollout &quot;https://github.com/microsoft/aurora/blob/main/aurora/rollout.py&quot;
    click Tracker &quot;https://github.com/microsoft/aurora/blob/main/aurora/tracker.py&quot;
    click FAPI &quot;https://github.com/microsoft/aurora/blob/main/aurora/foundry/client/api.py&quot;
    click FClient &quot;https://github.com/microsoft/aurora/blob/main/aurora/foundry/client/foundry.py&quot;
    click Channel &quot;https://github.com/microsoft/aurora/blob/main/aurora/foundry/common/channel.py&quot;
    click FModel &quot;https://github.com/microsoft/aurora/blob/main/aurora/foundry/common/model.py&quot;
    click Demo &quot;https://github.com/microsoft/aurora/tree/main/aurora/foundry/demo/&quot;
    click MLWrapper &quot;https://github.com/microsoft/aurora/blob/main/aurora/foundry/server/mlflow_wrapper.py&quot;
    click MLPlugin &quot;https://github.com/microsoft/aurora/blob/main/package_mlflow.py&quot;
    click Docs &quot;https://github.com/microsoft/aurora/tree/main/docs/&quot;
    click CI &quot;https://github.com/microsoft/aurora/blob/main/.github/workflows/ci.yaml&quot;
    click DocsBuild &quot;https://github.com/microsoft/aurora/blob/main/.github/workflows/build_docs.yaml&quot;
    click Format &quot;https://github.com/microsoft/aurora/blob/main/.github/workflows/formatting.yaml&quot;
    click Publish &quot;https://github.com/microsoft/aurora/blob/main/.github/workflows/publish.yaml&quot;
    click Makefile &quot;https://github.com/microsoft/aurora/tree/main/Makefile&quot;
    click Tests &quot;https://github.com/microsoft/aurora/tree/main/tests/&quot;

    %% Styles
    classDef core fill:#cce5ff,stroke:#339,stroke-width:1px
    classDef integration fill:#d4edda,stroke:#2a6b2d,stroke-width:1px
    classDef external fill:#ffe5b4,stroke:#cc8400,stroke-width:1px
    classDef docs fill:#f0e6ff,stroke:#8033a0,stroke-width:1px
    classDef ci fill:#ffe6e6,stroke:#cc0000,stroke-width:1px
    classDef tests fill:#e6ffe6,stroke:#00cc44,stroke-width:1px
    classDef actor fill:#ffffff,stroke:#000000,stroke-width:1px,stroke-dasharray: 2 2
</code></pre>
<p>graphcast结构图</p>
<pre><code class="language-mermaid">flowchart TB
    %% External Systems
    ECMWFZ[&quot;ECMWF Zarr Endpoints&quot;]:::ext
    GCS[&quot;Google Cloud Storage&quot;]:::ext

    %% Data Layer
    subgraph &quot;Data Layer&quot;
        DU[&quot;data_utils.py&quot;]:::data
        NORM[&quot;normalization.py&quot;]:::data
        CLEAN[&quot;nan_cleaning.py&quot;]:::data
        XJAX[&quot;xarray_jax.py&quot;]:::data
        XTREE[&quot;xarray_tree.py&quot;]:::data
    end

    %% Graph Layer
    subgraph &quot;Graph Layer&quot;
        IM[&quot;icosahedral_mesh.py&quot;]:::data
        GMC[&quot;grid_mesh_connectivity.py&quot;]:::data
        TG[&quot;typed_graph.py&quot;]:::data
        MU[&quot;model_utils.py&quot;]:::data
    end

    %% Model Layer
    subgraph &quot;Model Layer&quot;
        subgraph &quot;GraphCast Core Model&quot;
            GC[&quot;graphcast.py&quot;]:::core
            CAST[&quot;casting.py&quot;]:::core
            SOL[&quot;solar_radiation.py&quot;]:::core
        end
        subgraph &quot;GenCast Core Model&quot;
            GC2[&quot;gencast.py&quot;]:::core
            DEN[&quot;denoiser.py&quot;]:::core
            DB[&quot;denoisers_base.py&quot;]:::core
            DPS[&quot;dpm_solver_plus_plus_2s.py&quot;]:::core
        end
        subgraph &quot;Common Building Blocks&quot;
            DTGN[&quot;deep_typed_graph_net.py&quot;]:::data
            TGN[&quot;typed_graph_net.py&quot;]:::data
            MLP[&quot;mlp.py&quot;]:::data
            TRANS[&quot;transformer.py&quot;]:::data
            SPARSE[&quot;sparse_transformer.py&quot;]:::data
            SPUTIL[&quot;sparse_transformer_utils.py&quot;]:::data
        end
    end

    %% Runtime Layer
    subgraph &quot;Runtime Layer&quot;
        AR[&quot;autoregressive.py&quot;]:::runtime
        RO[&quot;rollout.py&quot;]:::runtime
        PB[&quot;predictor_base.py&quot;]:::runtime
        SB[&quot;samplers_base.py&quot;]:::runtime
        SU[&quot;samplers_utils.py&quot;]:::runtime
        CKPT[&quot;checkpoint.py&quot;]:::runtime
        LOSS[&quot;losses.py&quot;]:::runtime
    end

    %% Demos &amp; Notebooks
    subgraph &quot;Demos &amp; Notebooks&quot;
        D1[&quot;gencast_demo.ipynb&quot;]:::demo
        D2[&quot;gencast_demo_cloud_vm.ipynb&quot;]:::demo
        D3[&quot;gencast_mini_demo.ipynb&quot;]:::demo
        D4[&quot;graphcast_demo.ipynb&quot;]:::demo
    end

    %% Data Flow
    ECMWFZ --&gt; DU
    GCS --&gt; DU
    DU --&gt; IM
    DU --&gt; NORM
    DU --&gt; CLEAN
    DU --&gt; XJAX
    DU --&gt; XTREE
    IM --&gt; TG
    GMC --&gt; TG
    TG --&gt; GC
    TG --&gt; GC2
    DTGN --&gt; GC
    TGN --&gt; GC
    MLP --&gt; GC
    TRANS --&gt; GC
    SPARSE --&gt; GC
    SPUTIL --&gt; GC
    DTGN --&gt; GC2
    TGN --&gt; GC2
    MLP --&gt; GC2
    TRANS --&gt; GC2
    SPARSE --&gt; GC2
    SPUTIL --&gt; GC2
    GC --&gt; AR
    CAST --&gt; AR
    SOL --&gt; AR
    GC2 --&gt; AR
    DEN --&gt; AR
    DB --&gt; AR
    DPS --&gt; AR
    AR --&gt; LOSS
    LOSS --&gt; CKPT
    CKPT --&gt; AR
    AR --&gt; RO
    RO --&gt; GCS
    RO --&gt; D1
    RO --&gt; D2
    RO --&gt; D3
    RO --&gt; D4

    %% Click Events
    click DU &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/data_utils.py&quot;
    click NORM &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/normalization.py&quot;
    click CLEAN &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/nan_cleaning.py&quot;
    click XJAX &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/xarray_jax.py&quot;
    click XTREE &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/xarray_tree.py&quot;
    click IM &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/icosahedral_mesh.py&quot;
    click GMC &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/grid_mesh_connectivity.py&quot;
    click TG &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/typed_graph.py&quot;
    click MU &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/model_utils.py&quot;
    click GC &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/graphcast.py&quot;
    click CAST &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/casting.py&quot;
    click SOL &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/solar_radiation.py&quot;
    click GC2 &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/gencast.py&quot;
    click DEN &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/denoiser.py&quot;
    click DB &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/denoisers_base.py&quot;
    click DPS &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/dpm_solver_plus_plus_2s.py&quot;
    click DTGN &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/deep_typed_graph_net.py&quot;
    click TGN &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/typed_graph_net.py&quot;
    click MLP &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/mlp.py&quot;
    click TRANS &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/transformer.py&quot;
    click SPARSE &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/sparse_transformer.py&quot;
    click SPUTIL &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/sparse_transformer_utils.py&quot;
    click AR &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/autoregressive.py&quot;
    click RO &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/rollout.py&quot;
    click PB &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/predictor_base.py&quot;
    click SB &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/samplers_base.py&quot;
    click SU &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/samplers_utils.py&quot;
    click CKPT &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/checkpoint.py&quot;
    click LOSS &quot;https://github.com/google-deepmind/graphcast/blob/main/graphcast/losses.py&quot;

    %% Styles
    classDef data fill:#E0F7FA,stroke:#00838F,color:#004D40
    classDef core fill:#C8E6C9,stroke:#2E7D32,color:#1B5E20
    classDef runtime fill:#FFE0B2,stroke:#EF6C00,color:#E65100
    classDef ext fill:#ECEFF1,stroke:#90A4AE,color:#607D8B
    classDef demo fill:#F3E5F5,stroke:#8E24AA,color:#4A148C
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.indexes"], "search": "assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>